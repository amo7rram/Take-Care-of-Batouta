<!DOCTYPE html><html lang="en" dir="ltr"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
  <meta charset="UTF-8">
  <title>Middle Management Resume &amp; Leadership Profile Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #f6f8fb;
      --card: #ffffff;
      --card-2: #fafbff;
      --accent: #1554b3;
      --accent-2: #1e7a34;
      --text: #0b1220;
      --muted: #5a6a85;
      --danger: #d12f2f;
      --border: #dbe2ea;
      --focus: #2e7d32;
      --input-bg: #fff;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0b1220;
        --card: #111a2b;
        --card-2: #0e1727;
        --accent: #7cc0ff;
        --accent-2: #9fe870;
        --text: #e6eef8;
        --muted: #9bb3d1;
        --danger: #ff6b6b;
        --border: #21314b;
        --focus: #c7f284;
        --input-bg: #0a1322;
      }
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
      line-height: 1.55;
    }
    header {
      padding: 1.25rem 1rem .5rem;
      text-align: center;
    }
    header h1 {
      margin: 0 0 .4rem;
      font-size: 1.45rem;
      letter-spacing: .2px;
      color: var(--accent);
    }
    header p {
      margin: 0;
      color: var(--muted);
      font-size: .95rem;
    }
    .lang-switch {
      display: flex; gap: .5rem; justify-content: flex-end; align-items: center;
      padding: .5rem 1rem 0;
    }
    .lang-switch button {
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      padding: .45rem .7rem;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 600;
    }
    .lang-switch button.active {
      background: #e6f0ff;
      border-color: #b7d1ff;
      color: #0e3c86;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 1rem;
    }
    .card {
      background: linear-gradient(180deg, var(--card) 0%, var(--card-2) 100%);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 6px 20px rgba(0,0,0,.06);
    }
    .card h2 {
      font-size: 1.08rem;
      margin: .25rem 0 1rem;
      color: var(--accent);
    }
    .row { display: grid; grid-template-columns: 1fr; gap: .75rem; }
    @media (min-width: 640px) {
      .row.two { grid-template-columns: repeat(2, 1fr); }
      .row.three { grid-template-columns: repeat(3, 1fr); }
    }
    label {
      display: block;
      font-weight: 600;
      font-size: .9rem;
      margin-bottom: .25rem;
    }
    .hint { font-size: .82rem; color: var(--muted); margin-top: .15rem; }
    input, select, textarea {
      width: 100%;
      background: var(--input-bg);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 8px;
      padding: .6rem .7rem;
      outline: none;
      transition: border-color .15s, box-shadow .15s, background .2s;
    }
    textarea { min-height: 96px; resize: vertical; }
    input:focus, select:focus, textarea:focus {
      border-color: var(--focus);
      box-shadow: 0 0 0 3px rgba(46, 125, 50, .15);
    }
    .inline { display: flex; gap: .75rem; align-items: center; flex-wrap: wrap; }
    .chip {
      background: #eef3fb;
      border: 1px dashed var(--border);
      border-radius: 999px;
      padding: .35rem .7rem;
      font-size: .85rem;
      color: var(--muted);
    }
    .btnbar { display: flex; gap: .75rem; flex-wrap: wrap; }
    button {
      border: 1px solid var(--border);
      background: linear-gradient(180deg, #ffffff 0%, #f4f7fb 100%);
      color: var(--text);
      padding: .65rem .9rem;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: transform .05s ease, border-color .15s, background .2s;
    }
    button.primary {
      background: linear-gradient(180deg, #e9f2ff 0%, #dcedff 100%);
      border-color: #c9defd;
      color: #113a77;
    }
    button.accent {
      background: linear-gradient(180deg, #e9f7ee 0%, #dbf1e2 100%);
      border-color: #cfead7;
      color: #134b27;
    }
    button:hover { transform: translateY(-1px); }
    .error { color: var(--danger); font-size: .85rem; margin-top: .25rem; }
    .section-actions { display: flex; gap: .5rem; justify-content: flex-end; }
    hr.sep { border: none; height: 1px; background: var(--border); margin: .75rem 0; }
    small.req { color: var(--muted); }
  </style>
</head>
<body>
  <div class="lang-switch">
    <button type="button" id="enBtn" class="active">English</button>
    <button type="button" id="arBtn">العربية</button>
  </div>

  <header>
    <h1 data-i18n="title">Middle Management Resume &amp; Leadership Profile</h1>
    <p data-i18n="subtitle">Please complete all required fields. Data will be used to prepare competency models, leadership assessments, and 360 evaluations.</p>
  </header>

  <div class="container">
    <form id="profileForm" class="card" novalidate="">
      <div class="card">
        <h2 data-i18n="sec1">1) Personal &amp; Role Information</h2>
        <div class="row two">
          <div>
            <label for="firstName" data-i18n="firstName">First name *</label>
            <input id="firstName" name="firstName" required="">
            <div class="error" data-error-for="firstName"></div>
          </div>
          <div>
            <label for="lastName" data-i18n="lastName">Last name *</label>
            <input id="lastName" name="lastName" required="">
            <div class="error" data-error-for="lastName"></div>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="email" data-i18n="email">Work email *</label>
            <input id="email" name="email" type="email" required="">
            <div class="error" data-error-for="email"></div>
          </div>
          <div>
            <label for="employeeId" data-i18n="employeeId">Employee ID</label>
            <input id="employeeId" name="employeeId">
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="jobTitle" data-i18n="jobTitle">Current job title *</label>
            <input id="jobTitle" name="jobTitle" required="">
            <div class="error" data-error-for="jobTitle"></div>
          </div>
          <div>
            <label for="gradeLevel" data-i18n="gradeLevel">Grade/band level *</label>
            <select id="gradeLevel" name="gradeLevel" required="">
              <option value="" data-i18n="select">Select</option>
              <option>MM1</option><option>MM2</option><option>MM3</option><option>MM4</option>
            </select>
            <div class="error" data-error-for="gradeLevel"></div>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="department" data-i18n="department">Department *</label>
            <input id="department" name="department" required="">
            <div class="error" data-error-for="department"></div>
          </div>
          <div>
            <label for="location" data-i18n="location">Location (city, country) *</label>
            <input id="location" name="location" required="">
            <div class="error" data-error-for="location"></div>
          </div>
        </div>
        <div class="row three">
          <div>
            <label for="managerName" data-i18n="managerName">Direct manager name *</label>
            <input id="managerName" name="managerName" required="">
            <div class="error" data-error-for="managerName"></div>
          </div>
          <div>
            <label for="reports" data-i18n="reports">Direct reports (count) *</label>
            <input id="reports" name="reports" type="number" min="0" required="">
            <div class="error" data-error-for="reports"></div>
          </div>
          <div>
            <label for="tenure" data-i18n="tenure">Tenure in current role (years) *</label>
            <input id="tenure" name="tenure" type="number" min="0" step="0.1" required="">
            <div class="error" data-error-for="tenure"></div>
          </div>
        </div>
        <div class="row">
          <div>
            <label for="summary" data-i18n="summaryLabel">Professional summary (2–4 sentences) *</label>
            <textarea id="summary" name="summary" required="" placeholder="Brief overview of experience, strengths, and leadership focus." data-i18n-ph="summaryPH"></textarea>
            <div class="error" data-error-for="summary"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec2">2) Experience</h2>
        <div id="experienceList"></div>
        <div class="section-actions">
          <button type="button" id="addExperience" class="primary" data-i18n="addRole">+ Add role</button>
        </div>
        <hr class="sep">
        <div class="row">
          <div>
            <label for="keyAchievements" data-i18n="achievementsLabel">Top 3 achievements (impact, metrics) *</label>
            <textarea id="keyAchievements" name="keyAchievements" required="" placeholder="- Led X initiative resulting in Y% improvement...
- Delivered project under budget by Z%..." data-i18n-ph="achievementsPH"></textarea>
            <div class="error" data-error-for="keyAchievements"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec3">3) Education &amp; Certifications</h2>
        <div id="educationList"></div>
        <div class="section-actions">
          <button type="button" id="addEducation" class="primary" data-i18n="addEdu">+ Add education</button>
        </div>
        <hr class="sep">
        <div id="certList"></div>
        <div class="section-actions">
          <button type="button" id="addCert" class="primary" data-i18n="addCert">+ Add certification</button>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec4">4) Skills &amp; Competencies (self-assessment)</h2>
        <p class="hint" data-i18n="compHint">Rate current proficiency and importance to your role. Scale: 1 = Low, 5 = High.</p>
        <div id="competencyList"></div>
        <div class="section-actions">
          <button type="button" id="addCompetency" class="primary" data-i18n="addComp">+ Add competency</button>
        </div>
        <hr class="sep">
        <div class="row two">
          <div>
            <label for="techStack" data-i18n="techStack">Key tools/technologies</label>
            <input id="techStack" name="techStack" placeholder="e.g., Power BI, Salesforce, Python, SAP" data-i18n-ph="techPH">
          </div>
          <div>
            <label for="languages" data-i18n="languages">Languages</label>
            <input id="languages" name="languages" placeholder="e.g., English (Fluent), Arabic (Native)" data-i18n-ph="langPH">
          </div>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec5">5) Leadership &amp; People Management</h2>
        <div class="row two">
          <div>
            <label for="leadershipStyle" data-i18n="leadershipStyle">Leadership style (select closest) *</label>
            <select id="leadershipStyle" name="leadershipStyle" required="" data-i18n-select="leadershipOptions">
              <option value="" data-i18n="select">Select</option>
              <option>Coaching</option>
              <option>Transformational</option>
              <option>Servant</option>
              <option>Democratic</option>
              <option>Transactional</option>
              <option>Situational</option>
            </select>
            <div class="error" data-error-for="leadershipStyle"></div>
          </div>
          <div>
            <label for="spanOfControl" data-i18n="spanOfControl">Span of control (total team size) *</label>
            <input id="spanOfControl" name="spanOfControl" type="number" min="0" required="">
            <div class="error" data-error-for="spanOfControl"></div>
          </div>
        </div>
        <div class="row">
          <div>
            <label for="leadershipExamples" data-i18n="leadershipExamples">Leadership examples (situations, actions, results) *</label>
            <textarea id="leadershipExamples" name="leadershipExamples" required="" placeholder="Describe 2–3 situations where you led teams, drove change, or developed talent. Include outcomes/metrics." data-i18n-ph="leadershipExamplesPH"></textarea>
            <div class="error" data-error-for="leadershipExamples"></div>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="coachingMentoring" data-i18n="coachingMentoring">Coaching &amp; mentoring activities</label>
            <textarea id="coachingMentoring" name="coachingMentoring" placeholder="Frequency, programs, mentees, results" data-i18n-ph="coachPH"></textarea>
          </div>
          <div>
            <label for="succession" data-i18n="succession">Succession planning involvement</label>
            <textarea id="succession" name="succession" placeholder="Critical roles covered, successors identified, readiness" data-i18n-ph="successionPH"></textarea>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec6">6) Business Impact &amp; KPIs</h2>
        <div class="row two">
          <div>
            <label for="kpisOwned" data-i18n="kpisOwned">Primary KPIs owned *</label>
            <textarea id="kpisOwned" name="kpisOwned" required="" placeholder="- Revenue growth %, EBITDA, NPS, On-time delivery %, Safety TRIR, etc." data-i18n-ph="kpisOwnedPH"></textarea>
            <div class="error" data-error-for="kpisOwned"></div>
          </div>
          <div>
            <label for="kpiResults" data-i18n="kpiResults">Recent KPI results (last 12 months) *</label>
            <textarea id="kpiResults" name="kpiResults" required="" placeholder="- KPI: Target vs Actual, variance %, commentary" data-i18n-ph="kpiResultsPH"></textarea>
            <div class="error" data-error-for="kpiResults"></div>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="budgetResponsibility" data-i18n="budgetResponsibility">Budget responsibility (amount, scope)</label>
            <input id="budgetResponsibility" name="budgetResponsibility" placeholder="e.g., Opex $2.5M; Capex $1.2M" data-i18n-ph="budgetPH">
          </div>
          <div>
            <label for="projectPortfolio" data-i18n="projectPortfolio">Project portfolio overview</label>
            <textarea id="projectPortfolio" name="projectPortfolio" placeholder="Key programs/projects, status, ROI expectations" data-i18n-ph="portfolioPH"></textarea>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec7">7) 360° Inputs &amp; Stakeholders</h2>
        <div class="row two">
          <div>
            <label for="stakeholders" data-i18n="stakeholders">Key stakeholders</label>
            <textarea id="stakeholders" name="stakeholders" placeholder="- Internal: peers, cross-functional leaders
- External: clients, vendors, regulators" data-i18n-ph="stakeholdersPH"></textarea>
          </div>
          <div>
            <label for="feedbackChannels" data-i18n="feedbackChannels">Feedback channels used</label>
            <textarea id="feedbackChannels" name="feedbackChannels" placeholder="1:1s, pulse surveys, retros, client reviews" data-i18n-ph="feedbackPH"></textarea>
          </div>
        </div>
        <div id="raterList"></div>
        <div class="section-actions">
          <button type="button" id="addRater" class="primary" data-i18n="addRater">+ Add potential 360 rater</button>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec8">8) Development Plan</h2>
        <div class="row two">
          <div>
            <label for="strengths" data-i18n="strengths">Top strengths *</label>
            <textarea id="strengths" name="strengths" required="" placeholder="- Strategic thinking, stakeholder management, ..." data-i18n-ph="strengthsPH"></textarea>
            <div class="error" data-error-for="strengths"></div>
          </div>
          <div>
            <label for="growthAreas" data-i18n="growthAreas">Priority development areas *</label>
            <textarea id="growthAreas" name="growthAreas" required="" placeholder="- Delegation, financial acumen, influencing, ..." data-i18n-ph="growthPH"></textarea>
            <div class="error" data-error-for="growthAreas"></div>
          </div>
        </div>
        <div class="row two">
          <div>
            <label for="learningGoals" data-i18n="learningGoals">12-month learning goals</label>
            <textarea id="learningGoals" name="learningGoals" placeholder="- Course/certification targets, on-the-job stretch assignments" data-i18n-ph="learningPH"></textarea>
          </div>
          <div>
            <label for="supportNeeded" data-i18n="supportNeeded">Support needed from company</label>
            <textarea id="supportNeeded" name="supportNeeded" placeholder="Budget, mentor, exposure, tools" data-i18n-ph="supportPH"></textarea>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="sec9">9) Attachments (optional)</h2>
        <div class="row">
          <div>
            <label for="portfolioLinks" data-i18n="portfolioLinks">Portfolio or evidence links</label>
            <input id="portfolioLinks" name="portfolioLinks" placeholder="e.g., LinkedIn, case studies, dashboards" data-i18n-ph="portfolioLinksPH">
          </div>
        </div>
        <p class="hint" data-i18n="cvHint">If you have a CV file, please send it separately per instructions in the email.</p>
      </div>

      <div class="card">
        <h2 data-i18n="secDecl">Declaration</h2>
        <div class="inline">
          <input id="consent" name="consent" type="checkbox" required="">
          <label for="consent" data-i18n="consentText">I confirm the information provided is accurate and consent to its use for internal talent processes (competency mapping, leadership assessment, and 360 feedback).</label>
        </div>
        <div class="error" data-error-for="consent"></div>
      </div>

      <div class="btnbar">
        <button type="button" class="primary" id="validateBtn" data-i18n="validate">Validate</button>
        <button type="button" class="accent" id="downloadBtn" data-i18n="downloadJSON">Download JSON</button>
        <button type="submit" data-i18n="submit">Submit (preview JSON)</button>
      </div>
      <p class="hint" data-i18n="storeHint">Submission stores data only in your browser. Use “Download JSON” to send securely to HR.</p>
    </form>

    <div class="card" id="outputCard" style="display:none;">
      <h2 data-i18n="previewJSON">Preview JSON</h2>
      <pre id="jsonOutput" style="white-space: pre-wrap;"></pre>
    </div>
  </div>

  <script>
    // Simple i18n dictionary for EN/AR
    const i18n = {
      en: {
        title: "Middle Management Resume & Leadership Profile",
        subtitle: "Please complete all required fields. Data will be used to prepare competency models, leadership assessments, and 360 evaluations.",
        select: "Select",
        sec1: "1) Personal & Role Information",
        firstName: "First name *",
        lastName: "Last name *",
        email: "Work email *",
        employeeId: "Employee ID",
        jobTitle: "Current job title *",
        gradeLevel: "Grade/band level *",
        department: "Department *",
        location: "Location (city, country) *",
        managerName: "Direct manager name *",
        reports: "Direct reports (count) *",
        tenure: "Tenure in current role (years) *",
        summaryLabel: "Professional summary (2–4 sentences) *",
        summaryPH: "Brief overview of experience, strengths, and leadership focus.",
        sec2: "2) Experience",
        addRole: "+ Add role",
        achievementsLabel: "Top 3 achievements (impact, metrics) *",
        achievementsPH: "- Led X initiative resulting in Y% improvement...\n- Delivered project under budget by Z%...",
        sec3: "3) Education & Certifications",
        addEdu: "+ Add education",
        addCert: "+ Add certification",
        sec4: "4) Skills & Competencies (self-assessment)",
        compHint: "Rate current proficiency and importance to your role. Scale: 1 = Low, 5 = High.",
        addComp: "+ Add competency",
        techStack: "Key tools/technologies",
        techPH: "e.g., Power BI, Salesforce, Python, SAP",
        languages: "Languages",
        langPH: "e.g., English (Fluent), Arabic (Native)",
        sec5: "5) Leadership & People Management",
        leadershipStyle: "Leadership style (select closest) *",
        spanOfControl: "Span of control (total team size) *",
        leadershipExamples: "Leadership examples (situations, actions, results) *",
        leadershipExamplesPH: "Describe 2–3 situations where you led teams, drove change, or developed talent. Include outcomes/metrics.",
        coachingMentoring: "Coaching & mentoring activities",
        coachPH: "Frequency, programs, mentees, results",
        succession: "Succession planning involvement",
        successionPH: "Critical roles covered, successors identified, readiness",
        sec6: "6) Business Impact & KPIs",
        kpisOwned: "Primary KPIs owned *",
        kpisOwnedPH: "- Revenue growth %, EBITDA, NPS, On-time delivery %, Safety TRIR, etc.",
        kpiResults: "Recent KPI results (last 12 months) *",
        kpiResultsPH: "- KPI: Target vs Actual, variance %, commentary",
        budgetResponsibility: "Budget responsibility (amount, scope)",
        budgetPH: "e.g., Opex $2.5M; Capex $1.2M",
        projectPortfolio: "Project portfolio overview",
        portfolioPH: "Key programs/projects, status, ROI expectations",
        sec7: "7) 360° Inputs & Stakeholders",
        stakeholders: "Key stakeholders",
        stakeholdersPH: "- Internal: peers, cross-functional leaders\n- External: clients, vendors, regulators",
        feedbackChannels: "Feedback channels used",
        feedbackPH: "1:1s, pulse surveys, retros, client reviews",
        addRater: "+ Add potential 360 rater",
        sec8: "8) Development Plan",
        strengths: "Top strengths *",
        strengthsPH: "- Strategic thinking, stakeholder management, ...",
        growthAreas: "Priority development areas *",
        growthPH: "- Delegation, financial acumen, influencing, ...",
        learningGoals: "12-month learning goals",
        learningPH: "- Course/certification targets, on-the-job stretch assignments",
        supportNeeded: "Support needed from company",
        supportPH: "Budget, mentor, exposure, tools",
        sec9: "9) Attachments (optional)",
        portfolioLinks: "Portfolio or evidence links",
        portfolioLinksPH: "e.g., LinkedIn, case studies, dashboards",
        cvHint: "If you have a CV file, please send it separately per instructions in the email.",
        secDecl: "Declaration",
        consentText: "I confirm the information provided is accurate and consent to its use for internal talent processes (competency mapping, leadership assessment, and 360 feedback).",
        validate: "Validate",
        downloadJSON: "Download JSON",
        submit: "Submit (preview JSON)",
        storeHint: "Submission stores data only in your browser. Use “Download JSON” to send securely to HR.",
        previewJSON: "Preview JSON",
        // Dynamic section labels/options
        expTitle: "Experience",
        expCompany: "Company *",
        expTitleLabel: "Job title *",
        expStart: "Start date *",
        expEnd: "End date (or leave blank if current)",
        expEmpType: "Employment type *",
        expResp: "Key responsibilities & outcomes *",
        expRespPH: "Describe scope, team size, P&L, and measurable results.",
        expProj: "Notable projects (optional)",
        expProjPH: "Project name, your role, outcomes/ROI.",
        eduTitle: "Education",
        eduInst: "Institution *",
        eduDeg: "Degree / Program *",
        eduField: "Field of study",
        eduStart: "Start year *",
        eduEnd: "End year",
        eduHon: "Honors, activities (optional)",
        certTitle: "Certification",
        certName: "Certification *",
        certIssuer: "Issuing organization *",
        certIssued: "Issued (YYYY-MM) *",
        certExpires: "Expiration (YYYY-MM)",
        certStatus: "Status *",
        certCred: "Credential ID / URL",
        compTitle: "Competency",
        compArea: "Competency area *",
        compProf: "Proficiency (1–5) *",
        compImp: "Importance (1–5) *",
        compEvidence: "Evidence / examples *",
        compEvidencePH: "Briefly describe how you demonstrate this competency; include metrics where possible.",
        raterTitle: "Potential 360 Rater",
        raterName: "Name *",
        raterRelationship: "Relationship *",
        raterEmail: "Email (optional)",
        raterReason: "Why selected (optional)",
        remove: "Remove",
        // Options
        empTypes: ["Full-time","Part-time","Contract","Temporary","Consultant"],
        compAreas: ["Strategic Thinking","People Leadership","Communication","Execution & Delivery","Financial Acumen","Stakeholder Management","Change Management","Innovation","Customer Orientation","Risk & Compliance"],
        leadershipOptions: ["Select","Coaching","Transformational","Servant","Democratic","Transactional","Situational"],
        raterRelOptions: ["Manager","Peer","Direct Report","Cross-Functional Partner","Client/Vendor"],
        requiredErr: "This field is required.",
        emailErr: "Please enter a valid work email.",
        validatedMsg: "All required fields look good.",
        fixMsg: "Please fill in the highlighted required fields.",
        fixSubmit: "Please correct required fields."
      },
      ar: {
        title: "نموذج السيرة الذاتية والقيادة لمدراء الوسط",
        subtitle: "يرجى تعبئة جميع الحقول المطلوبة. ستُستخدم البيانات لإعداد نماذج الكفاءات وتقييمات القيادة وتقييمات 360.",
        select: "اختر",
        sec1: "1) المعلومات الشخصية والوظيفية",
        firstName: "الاسم الأول *",
        lastName: "اسم العائلة *",
        email: "البريد الإلكتروني الوظيفي *",
        employeeId: "رقم الموظف",
        jobTitle: "المسمى الوظيفي الحالي *",
        gradeLevel: "الدرجة/المستوى الوظيفي *",
        department: "الإدارة *",
        location: "الموقع (المدينة، الدولة) *",
        managerName: "اسم المدير المباشر *",
        reports: "عدد المرؤوسين المباشرين *",
        tenure: "مدة العمل في المنصب الحالي (بالسنوات) *",
        summaryLabel: "ملخص مهني (2–4 جمل) *",
        summaryPH: "نظرة عامة موجزة عن الخبرة ونقاط القوة ومحور القيادة.",
        sec2: "2) الخبرات",
        addRole: "+ إضافة وظيفة",
        achievementsLabel: "أبرز 3 إنجازات (الأثر، المقاييس) *",
        achievementsPH: "- قيادة مبادرة نتج عنها تحسن بنسبة ...%\n- تنفيذ مشروع بأقل من الميزانية بنسبة ...%...",
        sec3: "3) التعليم والشهادات",
        addEdu: "+ إضافة مؤهل",
        addCert: "+ إضافة شهادة",
        sec4: "4) المهارات والكفاءات (تقييم ذاتي)",
        compHint: "قيّم مستوى إتقانك وأهمية الكفاءة لدورك. المقياس: 1 منخفض، 5 مرتفع.",
        addComp: "+ إضافة كفاءة",
        techStack: "الأدوات/التقنيات الأساسية",
        techPH: "مثل: Power BI, Salesforce, Python, SAP",
        languages: "اللغات",
        langPH: "مثل: العربية (لغة أم)، الإنجليزية (بطلاقة)",
        sec5: "5) القيادة وإدارة الأفراد",
        leadershipStyle: "أسلوب القيادة (الأقرب) *",
        spanOfControl: "نطاق الإشراف (إجمالي حجم الفريق) *",
        leadershipExamples: "أمثلة قيادية (مواقف، إجراءات، نتائج) *",
        leadershipExamplesPH: "صف 2–3 مواقف قدت فيها فرقًا أو قدت التغيير أو طورت المواهب، مع النتائج/المقاييس.",
        coachingMentoring: "أنشطة التدريب والإرشاد",
        coachPH: "التواتر، البرامج، المتدربون، النتائج",
        succession: "المشاركة في التخطيط للتعاقب",
        successionPH: "الأدوار الحرجة المغطاة، الخلفاء المحددون، الجاهزية",
        sec6: "6) الأثر التجاري والمؤشرات",
        kpisOwned: "المؤشرات الأساسية المسؤولة عنها *",
        kpisOwnedPH: "- نمو الإيرادات %، هامش EBITDA، NPS، الالتزام بالتسليم في الوقت، TRIR للسلامة، إلخ.",
        kpiResults: "نتائج المؤشرات الأخيرة (آخر 12 شهرًا) *",
        kpiResultsPH: "- المؤشر: الهدف مقابل الفعلي، نسبة الانحراف، تعليق",
        budgetResponsibility: "مسؤولية الميزانية (القيمة، النطاق)",
        budgetPH: "مثال: مصاريف تشغيلية 2.5M$؛ رأسمالية 1.2M$",
        projectPortfolio: "نظرة عامة على محفظة المشاريع",
        portfolioPH: "البرامج/المشاريع الرئيسية، الحالة، العائد المتوقع",
        sec7: "7) مدخلات 360° وأصحاب المصلحة",
        stakeholders: "أهم أصحاب المصلحة",
        stakeholdersPH: "- داخلي: الزملاء، القادة عبر الوظائف\n- خارجي: العملاء، المورّدون، الجهات المنظمة",
        feedbackChannels: "قنوات التغذية الراجعة المستخدمة",
        feedbackPH: "اجتماعات فردية، استطلاعات نبض، مراجعات، تقييمات العملاء",
        addRater: "+ إضافة مُقيِّم 360 محتمل",
        sec8: "8) خطة التطوير",
        strengths: "أبرز نقاط القوة *",
        strengthsPH: "- التفكير الاستراتيجي، إدارة أصحاب المصلحة، ...",
        growthAreas: "أولويات التطوير *",
        growthPH: "- التفويض، الكفاءة المالية، التأثير، ...",
        learningGoals: "أهداف التعلم خلال 12 شهرًا",
        learningPH: "- دورات/شهادات، مهام تطويرية على رأس العمل",
        supportNeeded: "الدعم المطلوب من الشركة",
        supportPH: "ميزانية، مرشد، تعرّض وظيفي، أدوات",
        sec9: "9) مرفقات (اختياري)",
        portfolioLinks: "روابط الأعمال أو الأدلة",
        portfolioLinksPH: "مثل: LinkedIn، دراسات حالة، لوحات معلومات",
        cvHint: "إذا كان لديك ملف سيرة ذاتية، يرجى إرساله بشكل منفصل حسب التعليمات.",
        secDecl: "إقرار",
        consentText: "أُقرّ بصحة المعلومات وأوافق على استخدامها داخليًا (نمذجة الكفاءات، تقييم القيادة، وتقييم 360).",
        validate: "تحقق",
        downloadJSON: "تحميل JSON",
        submit: "إرسال (معاينة JSON)",
        storeHint: "سيتم حفظ الإرسال في متصفحك فقط. استخدم \"تحميل JSON\" لإرساله بأمان إلى الموارد البشرية.",
        previewJSON: "معاينة JSON",
        // Dynamic sections
        expTitle: "خبرة",
        expCompany: "الشركة *",
        expTitleLabel: "المسمى الوظيفي *",
        expStart: "تاريخ البدء *",
        expEnd: "تاريخ الانتهاء (اتركه فارغًا إذا كان حاليًا)",
        expEmpType: "نوع التوظيف *",
        expResp: "المسؤوليات والنتائج الرئيسية *",
        expRespPH: "صف نطاق العمل وحجم الفريق وP&L والنتائج القابلة للقياس.",
        expProj: "مشاريع بارزة (اختياري)",
        expProjPH: "اسم المشروع، دورك، النتائج/العائد.",
        eduTitle: "تعليم",
        eduInst: "الجهة التعليمية *",
        eduDeg: "الدرجة/البرنامج *",
        eduField: "التخصص",
        eduStart: "سنة البدء *",
        eduEnd: "سنة الانتهاء",
        eduHon: "التكريمات والأنشطة (اختياري)",
        certTitle: "شهادة",
        certName: "اسم الشهادة *",
        certIssuer: "الجهة المُصدِرة *",
        certIssued: "تاريخ الإصدار (YYYY-MM) *",
        certExpires: "تاريخ الانتهاء (YYYY-MM)",
        certStatus: "الحالة *",
        certCred: "معرّف/رابط الاعتماد",
        compTitle: "كفاءة",
        compArea: "مجال الكفاءة *",
        compProf: "إتقان (1–5) *",
        compImp: "أهمية (1–5) *",
        compEvidence: "أدلة/أمثلة *",
        compEvidencePH: "صف بإيجاز كيف تُظهر هذه الكفاءة مع مقاييس حيث أمكن.",
        raterTitle: "مُقيِّم 360 محتمل",
        raterName: "الاسم *",
        raterRelationship: "العلاقة *",
        raterEmail: "البريد الإلكتروني (اختياري)",
        raterReason: "سبب الاختيار (اختياري)",
        remove: "إزالة",
        // Options
        empTypes: ["دوام كامل","دوام جزئي","متعاقد","مؤقت","استشاري"],
        compAreas: ["التفكير الاستراتيجي","قيادة الأفراد","التواصل","التنفيذ وتسليم النتائج","الكفاءة المالية","إدارة أصحاب المصلحة","إدارة التغيير","الابتكار","تركيز على العميل","المخاطر والامتثال"],
        leadershipOptions: ["اختر","توجيهي (Coaching)","تحويلي","خدمي","ديمقراطي","تعاملي","موقفي (Situational)"],
        raterRelOptions: ["مدير","زميل","مرؤوس مباشر","شريك عبر الوظائف","عميل/مورد"],
        requiredErr: "هذا الحقل مطلوب.",
        emailErr: "يرجى إدخال بريد إلكتروني وظيفي صالح.",
        validatedMsg: "جميع الحقول المطلوبة سليمة.",
        fixMsg: "يرجى تعبئة الحقول المطلوبة المعلّمة.",
        fixSubmit: "يرجى تصحيح الحقول المطلوبة."
      }
    };

    // Utility to create elements
    function el(tag, attrs = {}, children = []) {
      const node = document.createElement(tag);
      Object.entries(attrs).forEach(([k, v]) => {
        if (k === 'class') node.className = v;
        else if (k === 'html') node.innerHTML = v;
        else node.setAttribute(k, v);
      });
      children.forEach(c => node.appendChild(c));
      return node;
    }

    // Dynamic sections
    const experienceList = document.getElementById('experienceList');
    const educationList = document.getElementById('educationList');
    const certList = document.getElementById('certList');
    const competencyList = document.getElementById('competencyList');
    const raterList = document.getElementById('raterList');

    document.getElementById('addExperience').addEventListener('click', () => {
      experienceList.appendChild(experienceItem());
      localizeDynamicCards();
    });
    document.getElementById('addEducation').addEventListener('click', () => {
      educationList.appendChild(educationItem());
      localizeDynamicCards();
    });
    document.getElementById('addCert').addEventListener('click', () => {
      certList.appendChild(certItem());
      localizeDynamicCards();
    });
    document.getElementById('addCompetency').addEventListener('click', () => {
      competencyList.appendChild(competencyItem());
      localizeDynamicCards();
    });
    document.getElementById('addRater').addEventListener('click', () => {
      raterList.appendChild(raterItem());
      localizeDynamicCards();
    });

    // Prefill with one item per section
    window.addEventListener('DOMContentLoaded', () => {
      document.getElementById('addExperience').click();
      document.getElementById('addEducation').click();
      document.getElementById('addCert').click();
      document.getElementById('addCompetency').click();
      document.getElementById('addRater').click();
    });

    function removableSection(title, contentEl) {
      const wrapper = el('div', { class: 'card i18n-scope' });
      const header = el('div', { class: 'inline' }, [
        el('h3', { style: 'margin:0; font-size:1rem; color:#1e7a34;', 'data-i18n': title.key }, [document.createTextNode(title.fallback)]),
        el('span', { class: 'chip' }, [document.createTextNode('')]),
      ]);
      const removeBtn = el('button', { type: 'button', style: 'margin-left:auto;', 'data-i18n': 'remove' }, [document.createTextNode('Remove')]);
      removeBtn.addEventListener('click', () => wrapper.remove());
      const top = el('div', { class: 'inline', style: 'justify-content: space-between; align-items:center; margin-bottom:.5rem;' }, [header, removeBtn]);
      wrapper.appendChild(top);
      wrapper.appendChild(contentEl);
      return wrapper;
    }

    function experienceItem() {
      const content = el('div', {}, [
        rowTwo([
          field({ key:'expCompany', fallback:'Company *' },'text','company', true),
          field({ key:'expTitleLabel', fallback:'Job title *' },'text','title', true),
        ]),
        rowThree([
          field({ key:'expStart', fallback:'Start date *' },'month','startDate', true),
          field({ key:'expEnd', fallback:'End date (or leave blank if current)' },'month','endDate', false),
          selectField({ key:'expEmpType', fallback:'Employment type *' },'employmentType', [], true, 'empTypes'),
        ]),
        fieldArea({ key:'expResp', fallback:'Key responsibilities & outcomes *' },'responsibilities', true, { key:'expRespPH', fallback:"Describe scope, team size, P&L, and measurable results." }),
        fieldArea({ key:'expProj', fallback:'Notable projects (optional)' },'projects', false, { key:'expProjPH', fallback:"Project name, your role, outcomes/ROI." }),
      ]);
      return removableSection({ key:'expTitle', fallback:'Experience' }, content);
    }

    function educationItem() {
      const content = el('div', {}, [
        rowTwo([
          field({ key:'eduInst', fallback:'Institution *' },'text','institution', true),
          field({ key:'eduDeg', fallback:'Degree / Program *' },'text','degree', true),
        ]),
        rowThree([
          field({ key:'eduField', fallback:'Field of study' },'text','field', false),
          field({ key:'eduStart', fallback:'Start year *' },'number','startYear', true, { min: 1950, max: 2100 }),
          field({ key:'eduEnd', fallback:'End year' },'number','endYear', false, { min: 1950, max: 2100 }),
        ]),
        fieldArea({ key:'eduHon', fallback:'Honors, activities (optional)' },'honors', false),
      ]);
      return removableSection({ key:'eduTitle', fallback:'Education' }, content);
    }

    function certItem() {
      const content = el('div', {}, [
        rowTwo([
          field({ key:'certName', fallback:'Certification *' },'text','certName', true),
          field({ key:'certIssuer', fallback:'Issuing organization *' },'text','issuer', true),
        ]),
        rowThree([
          field({ key:'certIssued', fallback:'Issued (YYYY-MM) *' },'month','issued', true),
          field({ key:'certExpires', fallback:'Expiration (YYYY-MM)' },'month','expires', false),
          selectField({ key:'certStatus', fallback:'Status *' },'certStatus', ['Active','Expired','In progress'], true),
        ]),
        field({ key:'certCred', fallback:'Credential ID / URL' },'text','credential', false),
      ]);
      return removableSection({ key:'certTitle', fallback:'Certification' }, content);
    }

    function competencyItem() {
      const content = el('div', {}, [
        rowThree([
          selectField({ key:'compArea', fallback:'Competency area *' },'competencyArea', [], true, 'compAreas'),
          rangeField({ key:'compProf', fallback:'Proficiency (1–5) *' },'proficiency', 1, 5, 1, true),
          rangeField({ key:'compImp', fallback:'Importance (1–5) *' },'importance', 1, 5, 1, true),
        ]),
        fieldArea({ key:'compEvidence', fallback:'Evidence / examples *' },'evidence', true, { key:'compEvidencePH', fallback:"Briefly describe how you demonstrate this competency; include metrics where possible." }),
      ]);
      return removableSection({ key:'compTitle', fallback:'Competency' }, content);
    }

    function raterItem() {
      const content = el('div', {}, [
        rowThree([
          field({ key:'raterName', fallback:'Name *' },'text','raterName', true),
          selectField({ key:'raterRelationship', fallback:'Relationship *' },'raterRelationship', [], true, 'raterRelOptions'),
          field({ key:'raterEmail', fallback:'Email (optional)' },'email','raterEmail', false),
        ]),
        fieldArea({ key:'raterReason', fallback:'Why selected (optional)' },'raterReason', false),
      ]);
      return removableSection({ key:'raterTitle', fallback:'Potential 360 Rater' }, content);
    }

    // Field helpers with i18n-aware labels/placeholders
    function field(labelI18n, type, name, required = false, extra = {}) {
      const id = name + '_' + Math.random().toString(36).slice(2,8);
      const wrap = el('div', {}, [
        el('label', { for: id, 'data-i18n': labelI18n.key }, [document.createTextNode(labelI18n.fallback)]),
        el('input', { id, name, type, ...extra, ...(required ? { required: '' } : {}) }),
        el('div', { class: 'error', 'data-error-for': id }),
      ]);
      return wrap;
    }

    function fieldArea(labelI18n, name, required = false, placeholderI18n = {key:'', fallback:''}) {
      const id = name + '_' + Math.random().toString(36).slice(2,8);
      const wrap = el('div', {}, [
        el('label', { for: id, 'data-i18n': labelI18n.key }, [document.createTextNode(labelI18n.fallback)]),
        el('textarea', { id, name, ...(required ? { required: '' } : {}), 'data-i18n-ph': placeholderI18n.key, placeholder: placeholderI18n.fallback }),
        el('div', { class: 'error', 'data-error-for': id }),
      ]);
      return wrap;
    }

    function selectField(labelI18n, name, options = [], required = false, dictKey = null) {
      const id = name + '_' + Math.random().toString(36).slice(2,8);
      const sel = el('select', { id, name, ...(required ? { required: '' } : {}), 'data-i18n-select': dictKey ? dictKey : '' }, [
        el('option', { value: '', 'data-i18n': 'select' }, [document.createTextNode('Select')]),
        ...options.map(o => el('option', {}, [document.createTextNode(o)]))
      ]);
      const wrap = el('div', {}, [
        el('label', { for: id, 'data-i18n': labelI18n.key }, [document.createTextNode(labelI18n.fallback)]),
        sel,
        el('div', { class: 'error', 'data-error-for': id }),
      ]);
      return wrap;
    }

    function rangeField(labelI18n, name, min, max, step = 1, required = false) {
      const id = name + '_' + Math.random().toString(36).slice(2,8);
      const valueLabel = el('span', { class: 'chip' }, [document.createTextNode('3')]);
      const input = el('input', { id, name, type: 'range', min, max, step, value: 3, ...(required ? { required: '' } : {}) });
      input.addEventListener('input', () => valueLabel.textContent = input.value);
      const wrap = el('div', {}, [
        el('label', { for: id, 'data-i18n': labelI18n.key }, [document.createTextNode(labelI18n.fallback)]),
        el('div', { class: 'inline' }, [input, valueLabel]),
        el('div', { class: 'error', 'data-error-for': id }),
      ]);
      return wrap;
    }

    function rowTwo(children) { return el('div', { class: 'row two' }, children); }
    function rowThree(children) { return el('div', { class: 'row three' }, children); }

    // Validation
    const form = document.getElementById('profileForm');
    document.getElementById('validateBtn').addEventListener('click', () => {
      const ok = validateForm();
      alert(tr(ok ? 'validatedMsg' : 'fixMsg'));
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (!validateForm()) {
        alert(tr('fixSubmit'));
        return;
      }
      const data = serializeForm();
      showJSON(data);
      window.scrollTo({ top: document.getElementById('outputCard').offsetTop - 20, behavior: 'smooth' });
    });

    function validateForm() {
      let valid = true;
      const requiredFields = form.querySelectorAll('[required]');
      requiredFields.forEach(f => {
        const errorEl = document.querySelector(`[data-error-for="${f.id}"]`);
        const show = (!f.value && f.type !== 'checkbox') || (f.type === 'checkbox' && !f.checked);
        if (show) {
          valid = false;
          if (errorEl) errorEl.textContent = tr('requiredErr');
          f.style.borderColor = 'var(--danger)';
        } else {
          if (errorEl) errorEl.textContent = '';
          f.style.borderColor = 'var(--border)';
        }
      });
      // Basic email check
      const email = document.getElementById('email');
      if (email && email.value && !/^\S+@\S+\.\S+$/.test(email.value)) {
        const errorEl = document.querySelector(`[data-error-for="${email.id}"]`);
        if (errorEl) errorEl.textContent = tr('emailErr');
        valid = false;
      }
      return valid;
    }

    // Serialize
    function serializeForm() {
      const data = {
        personal: {
          firstName: val('firstName'),
          lastName: val('lastName'),
          email: val('email'),
          employeeId: val('employeeId'),
          jobTitle: val('jobTitle'),
          gradeLevel: val('gradeLevel'),
          department: val('department'),
          location: val('location'),
          managerName: val('managerName'),
          reports: num('reports'),
          tenureYears: num('tenure'),
          summary: val('summary'),
        },
        experience: collectCards(experienceList, (card) => ({
          company: q(card, 'input[name^="company"]').value,
          title: q(card, 'input[name^="title"]').value,
          startDate: q(card, 'input[name^="startDate"]').value,
          endDate: q(card, 'input[name^="endDate"]').value,
          employmentType: q(card, 'select[name^="employmentType"]').value,
          responsibilities: q(card, 'textarea[name^="responsibilities"]').value,
          projects: q(card, 'textarea[name^="projects"]').value,
        })),
        achievements: val('keyAchievements'),
        education: collectCards(educationList, (card) => ({
          institution: q(card, 'input[name^="institution"]').value,
          degree: q(card, 'input[name^="degree"]').value,
          field: q(card, 'input[name^="field"]').value,
          startYear: q(card, 'input[name^="startYear"]').value,
          endYear: q(card, 'input[name^="endYear"]').value,
          honors: q(card, 'textarea[name^="honors"]').value,
        })),
        certifications: collectCards(certList, (card) => ({
          name: q(card, 'input[name^="certName"]').value,
          issuer: q(card, 'input[name^="issuer"]').value,
          issued: q(card, 'input[name^="issued"]').value,
          expires: q(card, 'input[name^="expires"]').value,
          status: q(card, 'select[name^="certStatus"]').value,
          credential: q(card, 'input[name^="credential"]').value,
        })),
        competencies: collectCards(competencyList, (card) => ({
          area: q(card, 'select[name^="competencyArea"]').value,
          proficiency: parseInt(q(card, 'input[name^="proficiency"]').value, 10),
          importance: parseInt(q(card, 'input[name^="importance"]').value, 10),
          evidence: q(card, 'textarea[name^="evidence"]').value,
        })),
        toolsAndLanguages: {
          techStack: val('techStack'),
          languages: val('languages'),
        },
        leadership: {
          style: val('leadershipStyle'),
          spanOfControl: num('spanOfControl'),
          examples: val('leadershipExamples'),
          coachingMentoring: val('coachingMentoring'),
          succession: val('succession'),
        },
        businessImpact: {
          kpisOwned: val('kpisOwned'),
          kpiResults: val('kpiResults'),
          budgetResponsibility: val('budgetResponsibility'),
          projectPortfolio: val('projectPortfolio'),
        },
        stakeholders360: {
          stakeholders: val('stakeholders'),
          feedbackChannels: val('feedbackChannels'),
          raters: collectCards(raterList, (card) => ({
            name: q(card, 'input[name^="raterName"]').value,
            relationship: q(card, 'select[name^="raterRelationship"]').value,
            email: q(card, 'input[name^="raterEmail"]').value,
            reason: q(card, 'textarea[name^="raterReason"]').value,
          })),
        },
        development: {
          strengths: val('strengths'),
          growthAreas: val('growthAreas'),
          learningGoals: val('learningGoals'),
          supportNeeded: val('supportNeeded'),
        },
        attachments: { portfolioLinks: val('portfolioLinks') },
        consent: document.getElementById('consent').checked,
        metadata: { formVersion: '1.1-i18n', submittedAt: new Date().toISOString(), lang: currentLang }
      };
      return data;
    }

    function collectCards(root, mapFn) {
      return Array.from(root.querySelectorAll(':scope > .card')).map(mapFn);
    }
    function q(root, selector) { return root.querySelector(selector); }
    function val(id) { const el = document.getElementById(id); return el ? el.value : ''; }
    function num(id) { const el = document.getElementById(id); return el && el.value !== '' ? Number(el.value) : null; }

    // Output and download
    const outCard = document.getElementById('outputCard');
    const outPre = document.getElementById('jsonOutput');
    function showJSON(data) {
      outPre.textContent = JSON.stringify(data, null, 2);
      outCard.style.display = 'block';
    }
    document.getElementById('downloadBtn').addEventListener('click', () => {
      if (!validateForm()) { alert(tr('fixSubmit')); return; }
      const data = serializeForm();
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `resume_leadership_profile_${data.personal.lastName || 'employee'}.json`;
      a.click();
      URL.revokeObjectURL(a.href);
    });

    // i18n switching
    let currentLang = 'en';
    const enBtn = document.getElementById('enBtn');
    const arBtn = document.getElementById('arBtn');

    enBtn.addEventListener('click', () => setLang('en'));
    arBtn.addEventListener('click', () => setLang('ar'));

    function tr(key) { return (i18n[currentLang] && i18n[currentLang][key]) || (i18n.en[key] || key); }

    function setLang(lang) {
      currentLang = lang;
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      enBtn.classList.toggle('active', lang === 'en');
      arBtn.classList.toggle('active', lang === 'ar');
      // Translate all static text
      document.querySelectorAll('[data-i18n]').forEach(elm => {
        const key = elm.getAttribute('data-i18n');
        elm.textContent = tr(key);
      });
      // Placeholders
      document.querySelectorAll('[data-i18n-ph]').forEach(elm => {
        const key = elm.getAttribute('data-i18n-ph');
        if (key) elm.placeholder = tr(key);
      });
      // Selects with dynamic option sets
      document.querySelectorAll('[data-i18n-select]').forEach(sel => {
        const dictKey = sel.getAttribute('data-i18n-select');
        if (!dictKey) return;
        const values = i18n[currentLang][dictKey] || i18n.en[dictKey] || [];
        // Preserve first "Select" option
        sel.innerHTML = '';
        const firstOpt = document.createElement('option');
        firstOpt.value = '';
        firstOpt.setAttribute('data-i18n','select');
        firstOpt.textContent = tr('select');
        sel.appendChild(firstOpt);
        values.forEach(v => {
          const o = document.createElement('option');
          o.textContent = v;
          sel.appendChild(o);
        });
      });
      // Leadership style static select
      const leaderSel = document.getElementById('leadershipStyle');
      if (leaderSel) {
        const opts = i18n[currentLang]['leadershipOptions'] || i18n.en['leadershipOptions'];
        const selected = leaderSel.value;
        leaderSel.innerHTML = '';
        opts.forEach((text, idx) => {
          const opt = document.createElement('option');
          opt.value = idx === 0 ? '' : text;
          opt.textContent = text;
          if (opt.value === selected) opt.selected = true;
          leaderSel.appendChild(opt);
        });
      }
    }

    function localizeDynamicCards() {
      // Apply i18n to any labels inside newly added cards
      setLang(currentLang);
    }

    // Initialize language based on browser preference
    (function initLang() {
      const prefersAr = (navigator.language || '').startsWith('ar');
      setLang(prefersAr ? 'ar' : 'en');
    })();
  </script>


</body></html>
